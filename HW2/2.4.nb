(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     13031,        321]
NotebookOptionsPosition[     11161,        281]
NotebookOutlinePosition[     11563,        297]
CellTagsIndexPosition[     11520,        294]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Exercise 2.4", "Title",
 CellChangeTimes->{{3.94188082067494*^9, 
  3.941880827646473*^9}},ExpressionUUID->"1c53561d-683e-244d-bcc2-\
45d3d839231e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]dot", "[", "\[Omega]_", "]"}], ":=", "\[Omega]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]dot", "[", 
    RowBox[{"\[Phi]_", ",", "\[Tau]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], "-", "\[Tau]", "-", "1"}], 
     ")"}]}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", 
   RowBox[{"\[Phi]_", ",", "\[Omega]_", ",", "\[Tau]_", ",", "C_"}], "]"}], 
  "=", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"\[Phi]dot", "[", "\[Omega]", "]"}], ",", "\[Omega]"}], "]"}], 
   "-", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"\[Omega]dot", "[", 
      RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}], ",", "\[Phi]"}], "]"}], " ", 
   "+", " ", "C", " "}]}]}], "Input",
 CellChangeTimes->{{3.9418808075167713`*^9, 3.941880807525772*^9}, {
   3.9418809813834248`*^9, 3.9418810938516273`*^9}, {3.9418814410250225`*^9, 
   3.9418814694596615`*^9}, {3.941881527682823*^9, 3.9418816188193607`*^9}, {
   3.941881652335642*^9, 3.94188170417885*^9}, {3.941881819211767*^9, 
   3.9418818499322567`*^9}, {3.9418819956435375`*^9, 
   3.9418819974190216`*^9}, {3.941882087154396*^9, 3.941882110896364*^9}, {
   3.941882566137018*^9, 3.941882577879242*^9}, 3.941882640692564*^9, {
   3.941882688124695*^9, 3.9418827776391735`*^9}, {3.941882813349905*^9, 
   3.9418829447720222`*^9}, {3.9418829833556137`*^9, 
   3.9418829916334305`*^9}, {3.941883056221081*^9, 3.9418830887097282`*^9}, {
   3.9418836163276615`*^9, 3.941883631032095*^9}, {3.941883754904274*^9, 
   3.9418839699731197`*^9}, {3.9418840706875305`*^9, 
   3.9418842022943554`*^9}, {3.9418844181561317`*^9, 3.9418844184095497`*^9}, 
   3.9418845232352333`*^9, {3.941884724508587*^9, 3.941884772413597*^9}, 
   3.941885173944193*^9},
 CellLabel->
  "In[230]:=",ExpressionUUID->"e7f9fdc7-f96b-124c-9c4d-2564236543c3"],

Cell[BoxData[
 RowBox[{"C", "+", 
  FractionBox[
   SuperscriptBox["\[Omega]", "2"], "2"], "-", 
  RowBox[{"Cos", "[", "\[Phi]", "]"}], "-", 
  RowBox[{"\[Tau]", " ", 
   RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"], "2"]}]], "Output",
 CellChangeTimes->{{3.9418810640758057`*^9, 3.9418810824131145`*^9}, 
   3.9418816282720585`*^9, 3.941881707356432*^9, 3.9418817841132526`*^9, 
   3.9418818201148434`*^9, 3.941881851075279*^9, {3.941882099490244*^9, 
   3.94188211201672*^9}, 3.941882578860174*^9, 3.9418826426436787`*^9, 
   3.9418827185238457`*^9, {3.941882761196764*^9, 3.94188277854735*^9}, {
   3.9418828635829296`*^9, 3.9418829393269615`*^9}, 3.941882985216688*^9, 
   3.9418830903359795`*^9, {3.941883622923172*^9, 3.941883631731596*^9}, {
   3.941883757252571*^9, 3.9418837683711853`*^9}, 3.941883825855398*^9, 
   3.941883890010153*^9, 3.9418839224638214`*^9, {3.941883962800089*^9, 
   3.9418839711397076`*^9}, {3.9418840778048744`*^9, 3.941884103856041*^9}, {
   3.941884142145149*^9, 3.9418841474444427`*^9}, {3.9418841929536686`*^9, 
   3.9418842031524944`*^9}, 3.941884420164034*^9, 3.9418845238907127`*^9, 
   3.9418847293031044`*^9, 3.9418847755069065`*^9, 3.9418852025291996`*^9, 
   3.9418856455838947`*^9},
 CellLabel->
  "Out[233]=",ExpressionUUID->"824fc64e-4561-b540-8028-5ac42b0fbdbf"]
}, Open  ]],

Cell["\<\

Set prefactor of \[Omega] to +1:\
\>", "Text",
 CellChangeTimes->{{3.941884794752018*^9, 3.941884801662319*^9}, {
  3.9418851784259663`*^9, 
  3.9418851846464634`*^9}},ExpressionUUID->"135f3718-ad4d-a74e-a973-\
38ff6d9dfdf9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hnormalized", "[", 
   RowBox[{"\[Phi]_", ",", "\[Omega]_", ",", "\[Tau]_", ",", "C_"}], "]"}], 
  " ", "=", " ", 
  RowBox[{
   RowBox[{"2", "*", 
    RowBox[{"H", "[", 
     RowBox[{"\[Phi]", ",", "\[Omega]", ",", "\[Tau]", ",", "C"}], " ", 
     "]"}]}], " ", "//", " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{3.941884753113001*^9},
 CellLabel->
  "In[234]:=",ExpressionUUID->"20fb5467-d616-fb49-b8de-aa74b80352fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "C"}], "+", 
  SuperscriptBox["\[Omega]", "2"], "-", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "\[Tau]"}], ")"}], " ", 
   RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"]}]], "Output",
 CellChangeTimes->{{3.9418810640758057`*^9, 3.9418810824131145`*^9}, 
   3.9418816282720585`*^9, 3.941881707356432*^9, 3.9418817841132526`*^9, 
   3.9418818201148434`*^9, 3.941881851075279*^9, {3.941882099490244*^9, 
   3.94188211201672*^9}, 3.941882578860174*^9, 3.9418826426436787`*^9, 
   3.9418827185238457`*^9, {3.941882761196764*^9, 3.94188277854735*^9}, {
   3.9418828635829296`*^9, 3.9418829393269615`*^9}, 3.941882985216688*^9, 
   3.9418830903359795`*^9, {3.941883622923172*^9, 3.941883631731596*^9}, {
   3.941883757252571*^9, 3.9418837683711853`*^9}, 3.941883825855398*^9, 
   3.941883890010153*^9, 3.9418839224638214`*^9, {3.941883962800089*^9, 
   3.9418839711397076`*^9}, {3.9418840778048744`*^9, 3.941884103856041*^9}, {
   3.941884142145149*^9, 3.9418841474444427`*^9}, {3.9418841929536686`*^9, 
   3.9418842031524944`*^9}, 3.941884420164034*^9, 3.9418845238907127`*^9, 
   3.9418847293072605`*^9, 3.9418847755519447`*^9, 3.941885202564741*^9, 
   3.941885645629822*^9},
 CellLabel->
  "Out[234]=",ExpressionUUID->"33523314-3265-bd4d-a31d-a423567d550c"]
}, Open  ]],

Cell["\<\

Find C such that the system is -1.\
\>", "Text",
 CellChangeTimes->{{3.9418848124008274`*^9, 3.9418848210724945`*^9}, 
   3.941885187315817*^9},ExpressionUUID->"52d578ef-aede-9a4a-8810-\
764321878918"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solC", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Hnormalized", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "\[Tau]", ",", "C"}], 
      "]"}], " ", "==", " ", 
     RowBox[{"-", "1"}]}], ",", "C"}], "]"}]}]], "Input",
 CellChangeTimes->{3.9418847604189816`*^9, 3.9418851943048897`*^9},
 CellLabel->
  "In[235]:=",ExpressionUUID->"0f6c98fb-a74c-9841-8f3a-9f8865fe1b75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"C", "\[Rule]", 
    RowBox[{"-", 
     FractionBox["1", "2"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.9418810640758057`*^9, 3.9418810824131145`*^9}, 
   3.9418816282720585`*^9, 3.941881707356432*^9, 3.9418817841132526`*^9, 
   3.9418818201148434`*^9, 3.941881851075279*^9, {3.941882099490244*^9, 
   3.94188211201672*^9}, 3.941882578860174*^9, 3.9418826426436787`*^9, 
   3.9418827185238457`*^9, {3.941882761196764*^9, 3.94188277854735*^9}, {
   3.9418828635829296`*^9, 3.9418829393269615`*^9}, 3.941882985216688*^9, 
   3.9418830903359795`*^9, {3.941883622923172*^9, 3.941883631731596*^9}, {
   3.941883757252571*^9, 3.9418837683711853`*^9}, 3.941883825855398*^9, 
   3.941883890010153*^9, 3.9418839224638214`*^9, {3.941883962800089*^9, 
   3.9418839711397076`*^9}, {3.9418840778048744`*^9, 3.941884103856041*^9}, {
   3.941884142145149*^9, 3.9418841474444427`*^9}, {3.9418841929536686`*^9, 
   3.9418842031524944`*^9}, 3.941884420164034*^9, 3.9418845238907127`*^9, 
   3.9418847293112984`*^9, 3.94188477557205*^9, 3.941885202587063*^9, 
   3.941885645653406*^9},
 CellLabel->
  "Out[235]=",ExpressionUUID->"5ab630ef-8696-914d-8aa4-adf2e9362565"]
}, Open  ]],

Cell["\<\

Double check solution. \
\>", "Text",
 CellChangeTimes->{{3.941884827257847*^9, 3.941884836627033*^9}, 
   3.941885190153015*^9},ExpressionUUID->"98b7123d-e0c3-134e-85a9-\
63dbf354e414"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hnormalized", "[", 
  RowBox[{
   RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "\[Tau]", ",", 
   RowBox[{"C", " ", "/.", 
    RowBox[{"solC", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{3.9418847665661926`*^9, 3.94188519637241*^9},
 CellLabel->
  "In[236]:=",ExpressionUUID->"bfd213d1-624b-2e45-aac3-471f0494b3f4"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.9418810640758057`*^9, 3.9418810824131145`*^9}, 
   3.9418816282720585`*^9, 3.941881707356432*^9, 3.9418817841132526`*^9, 
   3.9418818201148434`*^9, 3.941881851075279*^9, {3.941882099490244*^9, 
   3.94188211201672*^9}, 3.941882578860174*^9, 3.9418826426436787`*^9, 
   3.9418827185238457`*^9, {3.941882761196764*^9, 3.94188277854735*^9}, {
   3.9418828635829296`*^9, 3.9418829393269615`*^9}, 3.941882985216688*^9, 
   3.9418830903359795`*^9, {3.941883622923172*^9, 3.941883631731596*^9}, {
   3.941883757252571*^9, 3.9418837683711853`*^9}, 3.941883825855398*^9, 
   3.941883890010153*^9, 3.9418839224638214`*^9, {3.941883962800089*^9, 
   3.9418839711397076`*^9}, {3.9418840778048744`*^9, 3.941884103856041*^9}, {
   3.941884142145149*^9, 3.9418841474444427`*^9}, {3.9418841929536686`*^9, 
   3.9418842031524944`*^9}, 3.941884420164034*^9, 3.9418845238907127`*^9, 
   3.94188472931431*^9, 3.94188477559149*^9, 3.941885202604534*^9, 
   3.9418856456713085`*^9},
 CellLabel->
  "Out[236]=",ExpressionUUID->"f697c90d-8765-d14c-b076-29d89c877749"]
}, Open  ]],

Cell["Equal to -1, OK!\[LineSeparator]\[LineSeparator]Insert C in the \
conserved quantity.", "Text",
 CellChangeTimes->{{3.9418849715710964`*^9, 3.9418849788715935`*^9}, {
  3.9418855970855503`*^9, 
  3.9418856354553833`*^9}},ExpressionUUID->"1f5df33d-7d7c-064c-86d8-\
268aa2f815fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hnormalized", "[", 
  RowBox[{"\[Phi]", ",", "\[Omega]", ",", "\[Tau]", ",", 
   RowBox[{"C", " ", "/.", " ", 
    RowBox[{"solC", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9418855444063416`*^9, 3.941885590885895*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"60cac853-a275-f246-bdfe-a625774e9626"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  SuperscriptBox["\[Omega]", "2"], "-", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "\[Tau]"}], ")"}], " ", 
   RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"]}]], "Output",
 CellChangeTimes->{{3.941885576285803*^9, 3.9418855915317345`*^9}, 
   3.941885645683481*^9},
 CellLabel->
  "Out[237]=",ExpressionUUID->"6a4050f7-4b96-f449-950a-7e890ed1d66b"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{960, 472},
WindowMargins->{{-5.5, Automatic}, {Automatic, -5.5}},
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"40919fa0-63bb-2c46-ae4c-713a49e59e2b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 154, 3, 96, "Title",ExpressionUUID->"1c53561d-683e-244d-bcc2-45d3d839231e"],
Cell[CellGroupData[{
Cell[755, 29, 2037, 44, 104, "Input",ExpressionUUID->"e7f9fdc7-f96b-124c-9c4d-2564236543c3"],
Cell[2795, 75, 1390, 25, 48, "Output",ExpressionUUID->"824fc64e-4561-b540-8028-5ac42b0fbdbf"]
}, Open  ]],
Cell[4200, 103, 236, 7, 55, "Text",ExpressionUUID->"135f3718-ad4d-a74e-a973-38ff6d9dfdf9"],
Cell[CellGroupData[{
Cell[4461, 114, 459, 12, 28, "Input",ExpressionUUID->"20fb5467-d616-fb49-b8de-aa74b80352fb"],
Cell[4923, 128, 1378, 25, 32, "Output",ExpressionUUID->"33523314-3265-bd4d-a31d-a423567d550c"]
}, Open  ]],
Cell[6316, 156, 212, 6, 55, "Text",ExpressionUUID->"52d578ef-aede-9a4a-8810-764321878918"],
Cell[CellGroupData[{
Cell[6553, 166, 458, 12, 28, "Input",ExpressionUUID->"0f6c98fb-a74c-9841-8f3a-9f8865fe1b75"],
Cell[7014, 180, 1215, 21, 45, "Output",ExpressionUUID->"5ab630ef-8696-914d-8aa4-adf2e9362565"]
}, Open  ]],
Cell[8244, 204, 197, 6, 55, "Text",ExpressionUUID->"98b7123d-e0c3-134e-85a9-63dbf354e414"],
Cell[CellGroupData[{
Cell[8466, 214, 377, 9, 28, "Input",ExpressionUUID->"bfd213d1-624b-2e45-aac3-471f0494b3f4"],
Cell[8846, 225, 1112, 17, 32, "Output",ExpressionUUID->"f697c90d-8765-d14c-b076-29d89c877749"]
}, Open  ]],
Cell[9973, 245, 284, 5, 77, "Text",ExpressionUUID->"1f5df33d-7d7c-064c-86d8-268aa2f815fa"],
Cell[CellGroupData[{
Cell[10282, 254, 369, 8, 28, "Input",ExpressionUUID->"60cac853-a275-f246-bdfe-a625774e9626"],
Cell[10654, 264, 479, 13, 32, "Output",ExpressionUUID->"6a4050f7-4b96-f449-950a-7e890ed1d66b"]
}, Open  ]]
}, Open  ]]
}
]
*)

